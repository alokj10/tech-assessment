{"version":3,"sources":["../../src/commons/RoleDefinitions.js"],"names":["admin","orgadmin","staff","candidate","teacher","student","handleRoleNotFound","role","console","log","HandlePromise","db","queryConfig","userEntity","Promise","resolve","reject","sql","value","getSql","executeQuery","then","res","output","serializeToJson","catch","err","HandlePromiseWithParams","params","GetQueryConfig","action","queryConfigs","RoleDefinitions","queries","filter","queryItem","idx","key","allowedActions","VIEW_MCQS_QUERY","VIEW_MCQS_BY_SKILL_QUERY","VIEW_MCQS_BY_GRADE_QUERY","VIEW_MCQS_BY_DESCRIPTION_QUERY","VIEW_TESTS_QUERY","VIEW_TESTS_AVAILABLE_FOR_ME_QUERY","VIEW_MY_TESTS_QUERY","VIEW_TEST_BY_ID_QUERY","VIEW_INVITATIONS_QUERY","VIEW_USERS_QUERY","VIEW_ORGS_QUERY","VIEW_DASHBOARD_INVITATION","VIEW_DASHBOARD_TESTS","VIEW_DASHBOARD_MCQ","VIEW_GRADES_QUERY","VIEW_TEST_REGISTRATIONS_QUERY","VIEW_MY_TEST_REGISTRATIONS_QUERY","VIEW_REGISTRATIONS_FOR_TEST_QUERY","VIEW_TEST_REGISTRATION_BY_ID_QUERY"],"mappings":";;;;;;;AAAA;;;;AACA;;AAGA;;AAGA;;AAEA;;AACA;;AACA;;AACA;;AACA;;;;AAGO,IAAMA,wBAAQ,OAAd;AACA,IAAMC,8BAAW,UAAjB;AACA,IAAMC,wBAAQ,OAAd;AACA,IAAMC,gCAAY,WAAlB;AACA,IAAMC,4BAAU,SAAhB;AACA,IAAMC,4BAAU,SAAhB;;AAEA,IAAMC,kDAAqB,SAArBA,kBAAqB,CAACC,IAAD,EAAU;AACxCC,YAAQC,GAAR,CAAeF,IAAf;AACA,WAAO,EAAP;AACH,CAHM;;AAKA,IAAMG,wCAAgB,SAAhBA,aAAgB,CAACC,EAAD,EAAKC,WAAL,EAAkBC,UAAlB,EAAiC;AAC1D,WAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpC,YAAGJ,WAAH,EAAgB;AACZ,gBAAIK,MAAML,YAAYM,KAAZ,CAAkBC,MAAlB,CAAyBN,UAAzB,CAAV;AACA,gBAAG,CAACI,GAAJ,EAASD,OAAO,cAAP;AACTL,eAAGS,YAAH,CAAgBH,GAAhB,EAAqBI,IAArB,CAA0B,UAACC,GAAD,EAAS;AAC/B,oBAAGA,GAAH,EAAQ;AACJ,wBAAIC,SAASX,YAAYM,KAAZ,CAAkBM,eAAlB,CAAkCF,GAAlC,CAAb;AACAP,4BAAQQ,MAAR;AACH;AACJ,aALD,EAKGE,KALH,CAKS,UAACC,GAAD,EAAS;AACdV,uBAAOU,GAAP;AACH,aAPD;AAQH,SAXD,MAYK;AACDV,mBAAO,8BAAP;AACH;AACJ,KAhBM,CAAP;AAiBH,CAlBM;;AAoBA,IAAMW,4DAA0B,SAA1BA,uBAA0B,CAAChB,EAAD,EAAKC,WAAL,EAAkBgB,MAAlB,EAA6B;AAChE,WAAO,IAAId,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpC,YAAGJ,WAAH,EAAgB;AACZJ,oBAAQC,GAAR,CAAemB,MAAf;AACA,gBAAIX,MAAML,YAAYM,KAAZ,CAAkBC,MAAlB,CAAyBS,MAAzB,CAAV;AACA,gBAAG,CAACX,GAAJ,EAASD,OAAO,cAAP;AACTL,eAAGS,YAAH,CAAgBH,GAAhB,EAAqBI,IAArB,CAA0B,UAACC,GAAD,EAAS;AAC/B;AACA,oBAAGA,GAAH,EAAQ;AACJ,wBAAIC,SAASX,YAAYM,KAAZ,CAAkBM,eAAlB,CAAkCF,GAAlC,CAAb;AACA;AACAP,4BAAQQ,MAAR;AACH;AACJ,aAPD,EAOGE,KAPH,CAOS,UAACC,GAAD,EAAS;AACdV,uBAAOU,GAAP;AACH,aATD;AAUH,SAdD,MAeK;AACDV,mBAAO,8BAAP;AACH;AACJ,KAnBM,CAAP;AAoBH,CArBM;;AAuBA,IAAMa,0CAAiB,SAAjBA,cAAiB,CAACC,MAAD,EAAY;AACtC,QAAIC,eAAeC,gBAAgBC,OAAhB,CAAwBC,MAAxB,CAA+B,UAACC,SAAD,EAAYC,GAAZ,EAAoB;AAClE,eAAOD,UAAUE,GAAV,KAAkBP,MAAzB;AACH,KAFkB,CAAnB;AAGA,QAAIlB,cAAcmB,aAAa,CAAb,CAAlB;AACA,WAAOnB,WAAP;AACH,CANM;;AAQA,IAAMoB,4CAAkB;AACvBzB,UAAMP,KADiB;AAEvBsC,oBAAgB,CACZ,QADY,EACF,SADE,EACS,SADT,EACoB,aADpB,EACmC,UADnC,EAC+C,iBAD/C,EAEZ,gBAFY,EAGZ,WAHY,EAGC,UAHD,EAGa,WAHb,EAG0B,UAH1B,CAFO;AAOvBL,aAAS,CACLM,2BADK,EAELC,oCAFK,EAGLC,oCAHK,EAILC,0CAJK,EAKLC,6BALK,EAMLC,8CANK,EAOLC,gCAPK,EAQLC,kCARK,EASLC,yCATK,EAULC,6BAVK,EAWLC,2BAXK,EAYLC,2CAZK,EAaLC,sCAbK,EAcLC,oCAdK,EAeLC,+BAfK,EAgBLC,sDAhBK,EAiBLC,yDAjBK,EAkBLC,0DAlBK,EAmBLC,2DAnBK;AAPc,CAAxB","file":"RoleDefinitions.js","sourcesContent":["import globalQueries from '../db/queries';\r\nimport { VIEW_DASHBOARD_INVITATION,\r\n        VIEW_DASHBOARD_TESTS,\r\n        VIEW_DASHBOARD_MCQ } from './RoleBasedQueries/DashboardQueries';\r\nimport { VIEW_MCQS_QUERY, VIEW_MCQS_BY_SKILL_QUERY,\r\n    VIEW_MCQS_BY_GRADE_QUERY,\r\n    VIEW_MCQS_BY_DESCRIPTION_QUERY } from './RoleBasedQueries/McqQueries';\r\nimport { VIEW_TESTS, VIEW_TESTS_QUERY, VIEW_TEST_BY_ID_QUERY, \r\n    VIEW_MY_TESTS_QUERY, VIEW_TESTS_AVAILABLE_FOR_ME_QUERY } from './RoleBasedQueries/TestQueries';\r\nimport { VIEW_INVITATIONS_QUERY } from './RoleBasedQueries/InvitationQueries';\r\nimport { VIEW_USERS_QUERY } from './RoleBasedQueries/UserQueries';\r\nimport { VIEW_ORGS_QUERY } from './RoleBasedQueries/OrgQueries';\r\nimport { VIEW_GRADES_QUERY } from './RoleBasedQueries/GradeQueries';\r\nimport { VIEW_TEST_REGISTRATIONS_QUERY, VIEW_MY_TEST_REGISTRATIONS_QUERY,\r\n    VIEW_REGISTRATIONS_FOR_TEST_QUERY, VIEW_TEST_REGISTRATION_BY_ID_QUERY } from './RoleBasedQueries/TestRegistrationQueries';\r\n\r\nexport const admin = 'admin';\r\nexport const orgadmin = 'orgadmin';\r\nexport const staff = 'staff';\r\nexport const candidate = 'candidate';\r\nexport const teacher = 'teacher';\r\nexport const student = 'student';\r\n\r\nexport const handleRoleNotFound = (role) => {\r\n    console.log(`${role} role not found`);\r\n    return '';\r\n}\r\n\r\nexport const HandlePromise = (db, queryConfig, userEntity) => {\r\n    return new Promise((resolve, reject) => {\r\n        if(queryConfig) {\r\n            let sql = queryConfig.value.getSql(userEntity);\r\n            if(!sql) reject('unauthorized');\r\n            db.executeQuery(sql).then((res) => {\r\n                if(res) {\r\n                    let output = queryConfig.value.serializeToJson(res);\r\n                    resolve(output);\r\n                }\r\n            }).catch((err) => {\r\n                reject(err);\r\n            });\r\n        }\r\n        else {\r\n            reject('No query configuration found');\r\n        }\r\n    });\r\n}\r\n\r\nexport const HandlePromiseWithParams = (db, queryConfig, params) => {\r\n    return new Promise((resolve, reject) => {\r\n        if(queryConfig) {\r\n            console.log(`${params} params`);\r\n            let sql = queryConfig.value.getSql(params);\r\n            if(!sql) reject('unauthorized');\r\n            db.executeQuery(sql).then((res) => {\r\n                // console.log('execute query result: ', res);\r\n                if(res) {\r\n                    let output = queryConfig.value.serializeToJson(res);\r\n                    // console.log('resolving out:', output);\r\n                    resolve(output);\r\n                }\r\n            }).catch((err) => {\r\n                reject(err);\r\n            });\r\n        }\r\n        else {\r\n            reject('No query configuration found');\r\n        }\r\n    });\r\n}\r\n\r\nexport const GetQueryConfig = (action) => {\r\n    let queryConfigs = RoleDefinitions.queries.filter((queryItem, idx) => {\r\n        return queryItem.key === action;\r\n    });\r\n    let queryConfig = queryConfigs[0];\r\n    return queryConfig;\r\n}\r\n\r\nexport const RoleDefinitions = {\r\n        role: admin,\r\n        allowedActions: [\r\n            'addMcq', 'addTest', 'addUser', 'addCategory', 'addSkill', 'addOrganization', \r\n            'sendInvitation',\r\n            'viewTests', 'viewMcqs', 'viewUsers', 'viewOrgs'\r\n        ],\r\n        queries: [\r\n            VIEW_MCQS_QUERY,\r\n            VIEW_MCQS_BY_SKILL_QUERY,\r\n            VIEW_MCQS_BY_GRADE_QUERY,\r\n            VIEW_MCQS_BY_DESCRIPTION_QUERY,\r\n            VIEW_TESTS_QUERY,\r\n            VIEW_TESTS_AVAILABLE_FOR_ME_QUERY,\r\n            VIEW_MY_TESTS_QUERY,\r\n            VIEW_TEST_BY_ID_QUERY,\r\n            VIEW_INVITATIONS_QUERY,\r\n            VIEW_USERS_QUERY,\r\n            VIEW_ORGS_QUERY,\r\n            VIEW_DASHBOARD_INVITATION,\r\n            VIEW_DASHBOARD_TESTS,\r\n            VIEW_DASHBOARD_MCQ,\r\n            VIEW_GRADES_QUERY,\r\n            VIEW_TEST_REGISTRATIONS_QUERY,\r\n            VIEW_MY_TEST_REGISTRATIONS_QUERY,\r\n            VIEW_REGISTRATIONS_FOR_TEST_QUERY,\r\n            VIEW_TEST_REGISTRATION_BY_ID_QUERY\r\n        ]\r\n    }\r\n   "]}