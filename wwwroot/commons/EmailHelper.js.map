{"version":3,"sources":["../../src/commons/EmailHelper.js"],"names":["fs","require","EmailHelper","SendEmail","emailInfo","console","log","transporter","nodemailer","createTransport","host","EmailConfig","emailSmtpHost","port","emailSmtpPort","secure","requireTLS","auth","user","emailAuthUser","pass","emailAuthPassword","mailOptions","from","inviteFromEmailId","to","subject","html","CreateHtml","sendMail","error","info","messageId","response","GetHtmlTemplateByType","notificationType","replace","testName","testLink","rmaRequest","customerDetails","customerName","telephone","contactPerson","rmaLink","file","path","resolve","__dirname","readFileSync","encoding"],"mappings":";;;;;;AAAA;;;;AACA;;AAEA;;;;;;;;AADA,IAAIA,KAAKC,QAAQ,IAAR,CAAT;;IAGMC,W;;;;;SAEFC,S,GAAY,UAACC,SAAD,EAAe;AACvBC,gBAAQC,GAAR,CAAY,0BAAZ;AACA,YAAIC,cAAcC,qBAAWC,eAAX,CAA2B;AACzCC,kBAAMC,0BAAYC,aADuB;AAEzCC,kBAAMF,0BAAYG,aAFuB;AAGzCC,oBAAQ,KAHiC;AAIzCC,wBAAY,IAJ6B;AAKzCC,kBAAM;AACFC,sBAAMP,0BAAYQ,aADhB;AAEFC,sBAAMT,0BAAYU;AAFhB;AALmC,SAA3B,CAAlB;;AAWA,YAAIC,cAAc;AACdC,kBAAMZ,0BAAYa,iBADJ;AAEdC,gBAAIrB,UAAUqB,EAFA;AAGdC,qBAAStB,UAAUsB,OAHL;AAId;AACAC,kBAAM,MAAKC,UAAL,CAAgBxB,SAAhB;AALQ,SAAlB;;AAQAG,oBAAYsB,QAAZ,CAAqBP,WAArB,EAAkC,UAACQ,KAAD,EAAQC,IAAR,EAAiB;AAC/C,gBAAGD,KAAH,EAAU;AACNzB,wBAAQC,GAAR,CAAY,gCAAZ;AACAD,wBAAQC,GAAR,CAAYwB,KAAZ;AACA;AACH;AACDzB,oBAAQC,GAAR,CAAY,iBAAiByB,KAAKC,SAAtB,GAAkC,UAAlC,GAA+CD,KAAKE,QAAhE;AACH,SAPD;AAQH,K;;SAEDL,U,GAAa,UAACxB,SAAD,EAAe;AACxB,YAAIuB,OAAO,MAAKO,qBAAL,CAA2B9B,SAA3B,CAAX;AACA,YAAGA,UAAU+B,gBAAV,KAA+B,MAAlC,EAA0C;AACtCR,mBAAOA,KAAKS,OAAL,CAAa,eAAb,EAA8BhC,UAAUiC,QAAV,GAAqB,YAAnD,CAAP;AACAV,mBAAOA,KAAKS,OAAL,CAAa,eAAb,EAA8BhC,UAAUkC,QAAxC,CAAP;AACH;AACD,YAAGlC,UAAU+B,gBAAV,KAA+B,KAAlC,EAAyC;AACrC,gBAAG/B,UAAUmC,UAAV,CAAqBC,eAAxB,EAAyC;AACrCb,uBAAOA,KAAKS,OAAL,CAAa,mBAAb,EAAkChC,UAAUmC,UAAV,CAAqBC,eAArB,CAAqCC,YAAvE,CAAP;AACAd,uBAAOA,KAAKS,OAAL,CAAa,eAAb,EAA8BhC,UAAUmC,UAAV,CAAqBC,eAArB,CAAqCE,SAAnE,CAAP;AACAf,uBAAOA,KAAKS,OAAL,CAAa,oBAAb,EAAmChC,UAAUmC,UAAV,CAAqBC,eAArB,CAAqCG,aAAxE,CAAP;AACAhB,uBAAOA,KAAKS,OAAL,CAAa,cAAb,EAA6BhC,UAAUwC,OAAvC,CAAP;AACH;AACJ;AACD,eAAOjB,IAAP;AACH,K;;SAEDO,qB,GAAwB,UAAC9B,SAAD,EAAe;AACnC,YAAIuB,OAAO,EAAX;;AAEA,gBAAOvB,UAAU+B,gBAAjB;AAEI,iBAAK,MAAL;AACA;AACI,wBAAIU,OAAOC,eAAKC,OAAL,CAAaC,YAAY,8BAAzB,CAAX;AACA3C,4BAAQC,GAAR,CAAY,eAAZ,EAA6BuC,IAA7B;AACAlB,2BAAO3B,GAAGiD,YAAH,CAAgBJ,IAAhB,EAAsB,EAACK,UAAU,MAAX,EAAtB,CAAP;AACA;AACH;AACD,iBAAK,KAAL;AACA;AACI,wBAAIL,QAAOC,eAAKC,OAAL,CAAaC,YAAY,mBAAzB,CAAX;AACA3C,4BAAQC,GAAR,CAAY,eAAZ,EAA6BuC,KAA7B;AACAlB,2BAAO3B,GAAGiD,YAAH,CAAgBJ,KAAhB,EAAsB,EAACK,UAAU,MAAX,EAAtB,CAAP;AACA;AACH;AAfL;AAiBA,eAAOvB,IAAP;AACH,K;;;kBAEUzB,W;;AAEf","file":"EmailHelper.js","sourcesContent":["import nodemailer from 'nodemailer';\r\nimport { EmailConfig } from './ServerConfig';\r\nvar fs = require('fs');\r\nimport path from 'path';\r\n\r\nclass EmailHelper {\r\n\r\n    SendEmail = (emailInfo) => {\r\n        console.log('email helper send called');\r\n        let transporter = nodemailer.createTransport({\r\n            host: EmailConfig.emailSmtpHost,\r\n            port: EmailConfig.emailSmtpPort,\r\n            secure: false,\r\n            requireTLS: true,\r\n            auth: {\r\n                user: EmailConfig.emailAuthUser,\r\n                pass: EmailConfig.emailAuthPassword\r\n            }\r\n        });\r\n\r\n        let mailOptions = {\r\n            from: EmailConfig.inviteFromEmailId,\r\n            to: emailInfo.to,\r\n            subject: emailInfo.subject,\r\n            // text: emailInfo.text,\r\n            html: this.CreateHtml(emailInfo)\r\n        }\r\n\r\n        transporter.sendMail(mailOptions, (error, info) => {\r\n            if(error) {\r\n                console.log('error occured in sending email');\r\n                console.log(error);\r\n                return;\r\n            }\r\n            console.log('email sent: ' + info.messageId + ', resp: ' + info.response);\r\n        })\r\n    }\r\n\r\n    CreateHtml = (emailInfo) => {\r\n        let html = this.GetHtmlTemplateByType(emailInfo);\r\n        if(emailInfo.notificationType === 'test') {\r\n            html = html.replace('$$test_name$$', emailInfo.testName + ' Challenge');\r\n            html = html.replace('$$test_link$$', emailInfo.testLink);\r\n        }\r\n        if(emailInfo.notificationType === 'rma') {\r\n            if(emailInfo.rmaRequest.customerDetails) {\r\n                html = html.replace('$$customer_name$$', emailInfo.rmaRequest.customerDetails.customerName);\r\n                html = html.replace('$$telephone$$', emailInfo.rmaRequest.customerDetails.telephone);\r\n                html = html.replace('$$contact_person$$', emailInfo.rmaRequest.customerDetails.contactPerson);\r\n                html = html.replace('$$rma_link$$', emailInfo.rmaLink);\r\n            }\r\n        }\r\n        return html;\r\n    }\r\n\r\n    GetHtmlTemplateByType = (emailInfo) => {\r\n        let html = '';\r\n\r\n        switch(emailInfo.notificationType)\r\n        {\r\n            case 'test':\r\n            {\r\n                let file = path.resolve(__dirname + '/testinvitationTemplate.html');\r\n                console.log('template path', file); \r\n                html = fs.readFileSync(file, {encoding: 'utf8'});\r\n                break;\r\n            }\r\n            case 'rma':\r\n            {\r\n                let file = path.resolve(__dirname + '/rmatemplate.html');\r\n                console.log('template path', file); \r\n                html = fs.readFileSync(file, {encoding: 'utf8'});\r\n                break;\r\n            }\r\n        }\r\n        return html;\r\n    }\r\n}\r\nexport default EmailHelper;\r\n\r\n/*const htmlTemplate = `\r\n<style>\r\n.MuiTypography-subtitle1-87 {\r\n    color: rgba(0, 0, 0, 0.87);\r\n    font-size: 1rem;\r\n    font-family: \"Roboto\", \"Helvetica\", \"Arial\", sans-serif;\r\n    font-weight: 400;\r\n    line-height: 1.75;\r\n    letter-spacing: 0.00938em;\r\n}\r\n.MuiTypography-alignCenter-92 {\r\n    text-align: center;\r\n}\r\n.MuiTypography-root-69 {\r\n    margin: 0;\r\n    display: block;\r\n}\r\n.MuiTypography-button-80 {\r\n    color: rgba(0, 0, 0, 0.87);\r\n    font-size: 0.875rem;\r\n    font-weight: 500;\r\n    font-family: \"Roboto\", \"Helvetica\", \"Arial\", sans-serif;\r\n    text-transform: uppercase;\r\n}\r\n.MuiDivider-root-117 {\r\n    height: 1px;\r\n    margin: 0;\r\n    border: none;\r\n    flex-shrink: 0;\r\n    background-color: rgba(0, 0, 0, 0.12);\r\n}\r\n.MuiButton-sizeLarge-1131 {\r\n    padding: 8px 24px;\r\n    font-size: 0.9375rem;\r\n}\r\n.MuiButton-contained-1118 {\r\n    color: rgba(0, 0, 0, 0.87);\r\n    box-shadow: 0px 1px 5px 0px rgba(0,0,0,0.2), 0px 2px 2px 0px rgba(0,0,0,0.14), 0px 3px 1px -2px rgba(0,0,0,0.12);\r\n    background-color: #e0e0e0;\r\n}\r\n.MuiButton-root-1107 {\r\n    color: rgba(0, 0, 0, 0.87);\r\n    padding: 6px 16px;\r\n    font-size: 0.875rem;\r\n    min-width: 64px;\r\n    box-sizing: border-box;\r\n    transition: background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;\r\n    line-height: 1.75;\r\n    font-weight: 500;\r\n    font-family: \"Roboto\", \"Helvetica\", \"Arial\", sans-serif;\r\n    border-radius: 4px;\r\n    text-transform: uppercase;\r\n}\r\n.MuiButtonBase-root-57 {\r\n    color: inherit;\r\n    border: 0;\r\n    margin: 0;\r\n    cursor: pointer;\r\n    display: inline-flex;\r\n    outline: none;\r\n    padding: 0;\r\n    position: relative;\r\n    align-items: center;\r\n    user-select: none;\r\n    border-radius: 0;\r\n    vertical-align: middle;\r\n    justify-content: center;\r\n    -moz-appearance: none;\r\n    text-decoration: none;\r\n    background-color: transparent;\r\n    -webkit-appearance: none;\r\n    -webkit-tap-highlight-color: transparent;\r\n}\r\n.MuiButton-label-1108 {\r\n    width: 100%;\r\n    display: inherit;\r\n    align-items: inherit;\r\n    justify-content: inherit;\r\n}\r\n.MuiTouchRipple-root-259 {\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    display: block;\r\n    z-index: 0;\r\n    position: absolute;\r\n    overflow: hidden;\r\n    border-radius: inherit;\r\n    pointer-events: none;\r\n}\r\n.MuiButton-containedSecondary-1120 {\r\n    color: #fff;\r\n    background-color: #f50057;\r\n    border-radius: 4px;\r\n    padding: 1%;\r\n}\r\na {\r\n    text-decoration: none;\r\n}\r\nbutton {\r\n    align-items: flex-start;\r\n    text-align: center;\r\n    cursor: default;\r\n    color: buttontext;\r\n    background-color: buttonface;\r\n    box-sizing: border-box;\r\n    padding: 2px 6px 3px;\r\n    border-width: 2px;\r\n    border-style: outset;\r\n    border-color: buttonface;\r\n    border-image: initial;\r\n}\r\nbutton {\r\n    -webkit-writing-mode: horizontal-tb !important;\r\n}\r\n.MuiDivider-root-117 {\r\n    height: 1px;\r\n    margin: 0;\r\n    border: none;\r\n    flex-shrink: 0;\r\n    background-color: rgba(0, 0, 0, 0.12);\r\n}\r\nhr {\r\n    display: block;\r\n    unicode-bidi: isolate;\r\n    margin-block-start: 0.5em;\r\n    margin-block-end: 0.5em;\r\n    margin-inline-start: auto;\r\n    margin-inline-end: auto;\r\n    overflow: hidden;\r\n    border-style: inset;\r\n    border-width: 1px;\r\n}\r\n.MuiTypography-gutterBottom-96 {\r\n    margin-bottom: 0.35em;\r\n}\r\n.MuiTypography-alignCenter-92 {\r\n    text-align: center;\r\n}\r\n.MuiTypography-subtitle2-88 {\r\n    color: rgba(0, 0, 0, 0.87);\r\n    font-size: 0.875rem;\r\n    font-family: \"Roboto\", \"Helvetica\", \"Arial\", sans-serif;\r\n    font-weight: 500;\r\n    line-height: 1.57;\r\n    letter-spacing: 0.00714em;\r\n}\r\n.MuiTypography-headline-74 {\r\n    color: rgba(0, 0, 0, 0.87);\r\n    font-size: 1.9rem;\r\n    font-weight: 600;\r\n    font-family: \"Roboto\", \"Helvetica\", \"Arial\", sans-serif;\r\n    line-height: 1.65417em;\r\n    text-align: center;\r\n    padding: 2%;\r\n}\r\n</style>\r\n<body>\r\n<span class=\"MuiTypography-root-69 MuiTypography-headline-74 MuiCardHeader-title-1042\">$$test_name$$</span>\r\n<h3 class=\"MuiTypography-root-69 MuiTypography-subtitle1-87 MuiTypography-alignCenter-92\">\r\nYou have been invited to attend the Junior C# developer challenge. We wish you all the best!\r\n</h3>\r\n<div style=\"margin-top: 2%;\">\r\n<span class=\"MuiTypography-root-69 MuiTypography-button-80 MuiTypography-alignCenter-92\">\r\nDuration: 90 mins\r\n<br><br>\r\n<a href=\"$$test_link$$\" style=\"margin-top: 2%;\">\r\n<button class=\"MuiButtonBase-root-57 MuiButton-root-1107 MuiButton-contained-1118 MuiButton-containedSecondary-1120 MuiButton-raised-1121 MuiButton-raisedSecondary-1123 MuiButton-sizeLarge-1131\" tabindex=\"0\" type=\"button\" align=\"center\">\r\n<span class=\"MuiButton-label-1108\">\r\nStart Challenge\r\n</span>\r\n<span class=\"MuiTouchRipple-root-259\"></span>\r\n</button>\r\n</a>\r\n</span>\r\n</div>\r\n<hr class=\"MuiDivider-root-117\" style=\"margin-top: 2%;\">\r\n<h6 class=\"MuiTypography-root-69 MuiTypography-subtitle2-88 MuiTypography-gutterBottom-96 MuiTypography-alignCenter-92\" style=\"margin-top: 2%;\">\r\nFor any technical queries, please refer to <a href=\"#\">FAQ</a> or email us at support@techassessment.com\r\n</h6>\r\n</body>\r\n`;\r\n*/"]}