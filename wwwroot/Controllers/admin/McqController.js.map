{"version":3,"sources":["../../../src/Controllers/admin/McqController.js"],"names":["McqController","GetAll","req","resp","console","log","user","model","McqModel","then","res","status","send","catch","error","msg","GetMcqsBySkill","skill","query","role","users","UserRoles","admin","Add","body","mcq_meta","createdBy","id","createdOn","Date","toLocaleDateString","JSON","stringify","BulkMcq","bulkMcqToAdd","addedBy","emailId","BulkAddMcq","Update","Delete","BulkDelete","mcqIdsToDelete","DeleteByIds","BaseController"],"mappings":"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","file":"McqController.js","sourcesContent":["import db from '../../db';\r\nimport auth from '../../utils/auth';\r\nimport users from '../../users';\r\nimport McqModel from '../../Models/McqModel';\r\nimport BaseController from '../BaseController';\r\n\r\nclass McqController extends BaseController {\r\n\r\n    GetAll = (req, resp) => {\r\n        console.log('get all mcqs called', req.user);\r\n        // let mcqs = this.initializeCollection();\r\n        // if(req.user && req.user.role === users.UserRoles.admin) {\r\n        //     console.log(mcqs.data.length);\r\n        //     return resp.status(200).send(mcqs.data);\r\n        // }\r\n        // else {\r\n        //     this.GetMcqsByRecruiter(req, resp);\r\n        // }\r\n        let model = new McqModel();\r\n        model.GetAll(req.user)\r\n            .then((res) => {\r\n                console.log('mcq retrieved');\r\n                resp.status(200).send(res);\r\n            })\r\n            .catch((error) => {\r\n                let msg = \"Error in fetch MCQ: \" + error;\r\n                console.log(msg);\r\n                resp.status(500).send(msg);\r\n            })\r\n    }\r\n    \r\n    GetMcqsBySkill = (req, resp) => {\r\n        console.log('get mcqsBySkill called', req.user);\r\n        let { skill } = req.query;\r\n        let model = new McqModel();\r\n        req.user = {\r\n            role: users.UserRoles.admin\r\n        }\r\n        model.GetMcqsBySkill(req.user, skill)\r\n            .then((res) => {\r\n                console.log('mcq by skill retrieved');\r\n                resp.status(200).send(res);\r\n            })\r\n            .catch((error) => {\r\n                let msg = \"Error in fetch MCQs by skill: \" + error;\r\n                console.log(msg);\r\n                resp.status(500).send(msg);\r\n            })\r\n    }\r\n\r\n    // GetMcqsByRecruiter = (req, resp) => {\r\n    //     console.log('get all mcqs by recruiter called', req.user);\r\n    //     let mcqs = this.initializeCollection();\r\n    //     if(mcqs.data && mcqs.data.length > 0 && req.user) {\r\n    //         let filteredMcqs = mcqs.data.filter((item, index) => {\r\n    //             return item.addedBy = req.user.emailId;\r\n    //         });\r\n    //         console.log(filteredMcqs.length);\r\n    //         return resp.status(200).send(filteredMcqs);\r\n    //     }\r\n    //     resp.status(200).send(mcqs.data);\r\n    // }\r\n\r\n    Add = (req, resp) => {\r\n        console.log('Add Mcq called');\r\n        console.log(req.body);\r\n        // let mcqs = this.initializeCollection();\r\n        let { mcq_meta } = req.body;\r\n        let model = new McqModel();\r\n        mcq_meta.createdBy = req.user.id;\r\n        mcq_meta.createdOn = (new Date()).toLocaleDateString();\r\n\r\n        model.Add(mcq_meta)\r\n            .then((res) => {\r\n                if(res) {\r\n                    console.log('MCQ Added');\r\n                    resp.status(200).send(JSON.stringify(req.body));\r\n                }  \r\n            })\r\n            .catch((error) => {\r\n                let msg = \"Error in add MCQ: \" + error;\r\n                console.log(msg);\r\n                resp.status(500).send(msg);\r\n            });\r\n    }\r\n\r\n    BulkMcq = (req, resp) => {\r\n        console.log('Bulk Mcq called');\r\n        console.log(req.body);\r\n        let bulkMcqToAdd = req.body;\r\n        if(req.user) {\r\n            bulkMcqToAdd.addedBy = req.user.emailId;\r\n        }\r\n        let model = new McqModel(); \r\n        model.BulkAddMcq(bulkMcqToAdd)\r\n            .then((res) => {\r\n                if(res) {\r\n                    console.log('Bulk MCQ Added');\r\n                    resp.status(200).send(\"Success\");\r\n                }  \r\n            })\r\n            .catch((error) => {\r\n                let msg = \"Error in Bulk add MCQ: \" + error;\r\n                console.log(msg);\r\n                resp.status(500).send(msg);\r\n            });\r\n    }\r\n\r\n    Update = (req, resp) => {\r\n        console.log('update mcq called');\r\n        console.log(req.body);\r\n        let model = new McqModel(); \r\n        model.Update(req.body)\r\n            .then((res) => {\r\n                if(res) {\r\n                    console.log('MCQ Updated');\r\n                    resp.status(200).send(JSON.stringify(req.body));\r\n                }  \r\n            })\r\n            .catch((error) => {\r\n                let msg = \"Error in update MCQ: \" + error;\r\n                console.log(msg);\r\n                resp.status(500).send(msg);\r\n            });\r\n\r\n    }\r\n\r\n    Delete = (req, resp) => {\r\n        console.log('delete mcq called');\r\n        console.log(req.body);\r\n        let model = new McqModel();\r\n        model.Delete(req.body)\r\n            .then((res) => {\r\n                if(res) {\r\n                    console.log('MCQ Deleted');\r\n                    resp.status(200).send(JSON.stringify(req.body));\r\n                }  \r\n            })\r\n            .catch((error) => {\r\n                let msg = \"Error in delete MCQ: \" + error;\r\n                console.log(msg);\r\n                resp.status(500).send(msg);\r\n            });\r\n    }\r\n\r\n    \r\n    BulkDelete = (req, resp) => {\r\n        console.log('bulk delete mcq called');\r\n        console.log(req.body);\r\n        let model = new McqModel();\r\n        let { mcqIdsToDelete } = req.body; \r\n        model.DeleteByIds(mcqIdsToDelete)\r\n            .then((res) => {\r\n                if(res) {\r\n                    console.log('Bulk MCQ Deleted');\r\n                    resp.status(200).send('success');\r\n                }  \r\n            })\r\n            .catch((error) => {\r\n                let msg = \"Error in delete MCQ: \" + error;\r\n                console.log(msg);\r\n                resp.status(500).send(msg);\r\n            });\r\n    }\r\n\r\n}\r\n\r\nexport default new McqController();"]}