{"version":3,"sources":["../src/routes.js"],"names":["api","express","Router","get","UserController","LoadConfig","auth","McqController","GetAll","GetMcqsBySkill","post","Add","put","Update","delete","Delete","BulkDelete","BulkMcq","CategoryController","SkillController","OrgController","RmaRequestController","AdminTestController","GetMcqsByTestId","GetCandidatesByTestId","GetTest","CandidateResponseController","GetCandidateResponse","GetCandidateDetails","TestInviteController","GetInvitation","SendInvite","StartTest","SubmitAnswers","EvaluateAnswers","DashboardController","GetTestCount","GetMcqCount","GetInvitationCount","passport","authenticate","session","scope","req","res","next","console","log","user","status","send","generateToken","sendToken","AuthenticateCandidate","failureRedirect","redirect"],"mappings":"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","file":"routes.js","sourcesContent":["import express  from 'express';\r\nimport { McqController, CategoryController, SkillController,\r\n        CandidateController, AdminTestController, InviteController,\r\n        UserController } from './Controllers/admin';\r\nimport { TestInviteController } from './Controllers/candidate';\r\n\r\nimport { RmaRequestController } from './Controllers/hitech';\r\n\r\nimport { generateToken, sendToken } from './utils/token.utils';\r\nimport passport from 'passport';\r\nimport auth from './utils/auth';\r\nimport OrgController from './Controllers/admin/OrgController';\r\nimport DashboardController from './Controllers/admin/DashboardController';\r\nimport CandidateResponseController from './Controllers/admin/CandidateResponseController';\r\n\r\n\r\nlet api = express.Router();\r\n\r\n\r\napi.get('/loadConfig', UserController.LoadConfig);\r\n\r\n/* Admin Routes */\r\n/* mcq endpoints */\r\n// api.get('/admin/getAllMcqs', McqController.GetAll);\r\napi.get('/admin/getAllMcqs', auth, McqController.GetAll);\r\napi.get('/admin/getMcqsBySkill', auth, McqController.GetMcqsBySkill);\r\napi.post('/admin/mcq', auth, McqController.Add);\r\napi.put('/admin/mcq', auth, McqController.Update);\r\napi.delete('/admin/mcq', auth, McqController.Delete);\r\napi.delete('/admin/bulkmcq', McqController.BulkDelete);\r\napi.post('/admin/bulkMcq', auth, McqController.BulkMcq);\r\n\r\n/* category endpoints */\r\napi.get('/admin/getAllCategories', auth, CategoryController.GetAll);\r\napi.post('/admin/category', auth, CategoryController.Add);\r\napi.put('/admin/category', auth, CategoryController.Update);\r\napi.delete('/admin/category', auth, CategoryController.Delete);\r\n\r\n/* skill endpoints */\r\napi.get('/admin/getAllSkills', auth, SkillController.GetAll);\r\napi.post('/admin/skill', auth, SkillController.Add);\r\napi.delete('/admin/skill', auth, SkillController.Delete);\r\n\r\n/* org endpoints */\r\napi.get('/admin/getAllOrgs', auth, OrgController.GetAll);\r\napi.post('/admin/org', auth, OrgController.Add);\r\napi.put('/admin/org', auth, OrgController.Update);\r\napi.delete('/admin/org', auth, OrgController.Delete);\r\n\r\n/* hitech endpoints */\r\napi.get('/hitech/rmaRequests', RmaRequestController.GetAll);\r\napi.post('/hitech/rmaRequest', RmaRequestController.Add);\r\napi.get('/hitech/deleteRmaRequest', RmaRequestController.Delete);\r\n\r\n/* Admin Test endpoints */\r\napi.get('/admin/getAllTests', auth, AdminTestController.GetAll);\r\napi.get('/admin/getMcqsByTestId', auth, AdminTestController.GetMcqsByTestId);\r\napi.get('/admin/getCandidatesByTestId', auth, AdminTestController.GetCandidatesByTestId);\r\napi.get('/admin/getTest', auth, AdminTestController.GetTest);\r\napi.post('/admin/test', auth, AdminTestController.Add);\r\napi.put('/admin/test', auth, AdminTestController.Update);\r\napi.delete('/admin/test', auth, AdminTestController.Delete);\r\n\r\n/* User endpoints */\r\napi.get('/admin/getAllUsers', auth,  UserController.GetAll);\r\napi.post('/admin/user', auth, UserController.Add);\r\napi.put('/admin/user', auth, UserController.Update);\r\napi.delete('/admin/user', auth, UserController.Delete);\r\n\r\n/* Candidate Response Endpoints */\r\napi.get('/admin/getCandidateResponseReport', auth, CandidateResponseController.GetCandidateResponse);\r\napi.get('/admin/getCandidateDetails', auth, CandidateResponseController.GetCandidateDetails);\r\n\r\n/* Candidate Routes */\r\n/* Test Invite endpoints */\r\napi.get('/candidate/getAllInvites', auth, TestInviteController.GetAll);\r\napi.get('/candidate/invitation', TestInviteController.GetInvitation);\r\napi.post('/candidate/sendInvite', auth, TestInviteController.SendInvite);\r\napi.post('/candidate/startTest', auth, TestInviteController.StartTest);\r\napi.post('/candidate/submitAnswers', auth, TestInviteController.SubmitAnswers);\r\napi.post('/candidate/evaluateAnswers', auth, TestInviteController.EvaluateAnswers);\r\n\r\napi.get('/admin/dashboard/test/count', auth, DashboardController.GetTestCount);\r\napi.get('/admin/dashboard/mcq/count', auth, DashboardController.GetMcqCount);\r\napi.get('/admin/dashboard/invitation/count', auth, DashboardController.GetInvitationCount);\r\n// api.get('/admin/dashboard', auth, DashboardController.GetAllStatistics);\r\n\r\napi.get('/admin/auth/google',\r\n    passport.authenticate('google-token', { session: false, scope: ['https://www.googleapis.com/auth/plus.login'] }),\r\n    (req, res, next) => {\r\n        console.log('res next');\r\n        req.auth = req.user;\r\n        if(req.user.status === 'not found') {\r\n            return res.status(403).send('User Not Found');\r\n        }\r\n        next();\r\n    }, generateToken, sendToken);\r\n\r\n    \r\napi.post('/admin/auth/local',passport.authenticate('local',{session: false}),\r\n   (req, res, next) => {\r\n    console.log('received local call');\r\n    req.auth = req.user;\r\n        if(req.user.status === 'not found') {\r\n            return res.status(401).send('User Not Found');\r\n        }\r\n        next();\r\n}, generateToken, sendToken);\r\n\r\n\r\napi.post('/candidate/auth/local',TestInviteController.AuthenticateCandidate,\r\n   (req, res, next) => {\r\n       console.log('returned from authenticate candidate', req.user);\r\n        req.auth = req.user;\r\n        if(req.user.status === 'not found') {\r\n            return res.status(401).send('Candidate Not Registered');\r\n        }\r\n        next();\r\n}, generateToken, sendToken);\r\n\r\n// GET /auth/google/callback\r\n//   Use passport.authenticate() as route middleware to authenticate the\r\n//   request.  If authentication fails, the user will be redirected back to the\r\n//   login page.  Otherwise, the primary route function function will be called,\r\n//   which, in this example, will redirect the user to the home page.\r\napi.get('/admin/auth/google/callback', \r\n  passport.authenticate('google-token', { failureRedirect: '/login' }),\r\n  function(req, res) {\r\n      console.log('res 3');\r\n    res.redirect('/');\r\n  });\r\n\r\n/*\r\napi.route('/admin/auth/callback', (req, resp) => {\r\n    console.log('admin api callback called');\r\n})\r\napi.get('/admin/auth/google',\r\n        passport.authenticate('google-token'), \r\n        (req, res, next) => {\r\n            console.log('res returned');\r\n            if (!req.user) {\r\n                return res.send(401, 'User Not Authenticated');\r\n            }\r\n            req.auth = {\r\n                id: req.user.id\r\n            };\r\n            next();\r\n        }, \r\n        generateToken, \r\n        sendToken);*/\r\nexport default api;\r\n"]}